import json
import csv
import uuid

# Load the JSON files
with open("artwork_data.json", "r") as artwork_file, open("artists.json", "r") as artists_file:
    artworks = json.load(artwork_file)
    artists = json.load(artists_file)

# Create a mapping of artist names to artist IDs
artist_mapping = {artist["full_name"]: artist["artist_id"] for artist in artists}

# Prepare data for CSV
csv_data = []
for artwork in artworks:
    # Generate a unique image ID
    image_id = str(uuid.uuid4())
    image_url = artwork.get("image_url", "")
    artist_name = artwork.get("artist", "")
    artist_id = artist_mapping.get(artist_name, "unknown")  # Default to "unknown" if artist not found
    
    # Append the row
    csv_data.append({
        "image_id": image_id,
        "image_url": image_url,
        "artist_id": artist_id,
    })

# Write to a CSV file
csv_file = "artwork_data.csv"
with open(csv_file, "w", newline="", encoding="utf-8") as file:
    writer = csv.DictWriter(file, fieldnames=["image_id", "image_url", "artist_id"])
    writer.writeheader()
    writer.writerows(csv_data)

print(f"CSV file '{csv_file}' created successfully!")
